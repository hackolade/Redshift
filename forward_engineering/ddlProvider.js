"use strict";var fe=Object.defineProperty;var o=(l,p)=>fe(l,"name",{value:p,configurable:!0});var F=(l,p)=>()=>(p||l((p={exports:{}}).exports,p),p.exports);var te=F((Pe,ee)=>{"use strict";ee.exports={number:"DECIMAL",string:"VARCHAR",date:"DATE",timestamp:"TIMESTAMP",binary:"BINARY",boolean:"BOOLEAN",document:"SUPER",objectId:"VARCHAR(24)",default:"CHAR"}});var D=F((Oe,re)=>{"use strict";re.exports={createDatabase:"",createSchema:'CREATE SCHEMA${ifNotExist} "${name}"${authorization}${quota};\n',createExternalSchema:'CREATE EXTERNAL SCHEMA${ifNotExist} "${name}" FROM ${source} DATABASE "${sourceDBName}"${sourceSchemaName}${region}${uri} IAM_ROLE "${iamRole}"${secretARN}${catalogRole}${createExternalDatabase};\n',createTable:'CREATE ${temporary}TABLE${ifNotExist} "${schemaName}"."${name}"(${columnDefinitions}${tableConstraints}${likeStatement})${tableAttributes};\n${comment}${columnDescriptions}',createTableAs:'CREATE ${temporary}TABLE "${schemaName}"."${name}" ${backup}${tableAttribute} AS ${query};\n${comment}${columnDescriptions}',createView:'CREATE${orReplace} VIEW "${schemaName}"."${name}"(\n	${column_list}\n)\nAS SELECT ${table_columns}\nFROM ${table_name}${withNoSchema};\n${comment}',createMaterializedView:'CREATE MATERIALIZED VIEW "${schemaName}"."${name}"${backup}${tableAttributes}${autoRefresh}\nAS SELECT ${table_columns}\nFROM ${table_name};\n${comment}',createFunction:"CREATE${orReplace}FUNCTION ${name} (${arguments})\n	RETURNS ${returnDataType}\n${volatility}\nAS $$\n${statement}\n$$ LANGUAGE ${language};\n",createProcedure:"CREATE${orReplace}PROCEDURE ${name} (${arguments})\nAS $$\n${statement}\n$$ LANGUAGE plpgsql${securityMode}${configurationParameter};\n",columnDefinition:'"${name}" ${type}${default}${encoding}${distKey}${sortKey}${notNull}${unique}${primaryKey}${inlineConstraints}${references}',compoundSortKey:"${sortStyle} SORTKEY (${keys})",compoundUniqueKey:"UNIQUE (${keys})",compoundPrimaryKey:"PRIMARY KEY (${keys})",createTableForeignKey:"FOREIGN KEY (${columns}) REFERENCES ${primary_table} (${primary_columns})",dropSchema:"DROP SCHEMA IF EXISTS ${name};",alterSchema:"ALTER SCHEMA ${name}${quota};",dropFunction:"DROP FUNCTION ${name} (${arguments});",dropProcedure:"DROP PROCEDURE ${name} (${arguments});",dropTable:"DROP TABLE IF EXISTS ${name};",alterDistKey:"ALTER TABLE ${name} ALTER ${distConstraint};",alterSortKey:"ALTER TABLE ${name} ALTER ${sortKeyConstraint};",alterPrimaryKey:"ALTER TABLE ${name} ADD ${primaryKeyConstraint};",alterUnique:"ALTER TABLE ${name} ADD ${uniqueConstraint};",renameColumn:'ALTER TABLE ${tableName} RENAME COLUMN "${oldColumnName}" TO "${newColumnName}";',alterColumnType:'ALTER TABLE ${tableName} ALTER COLUMN "${columnName}" TYPE ${type};',addColumn:"ALTER TABLE ${tableName} ADD COLUMN ${columnStatement};",dropColum:'ALTER TABLE ${tableName} DROP COLUMN "${columnName}";',dropView:"DROP VIEW IF EXISTS ${name};",comment:"\nCOMMENT ON ${object} ${objectName} IS ${comment};\n"}});var se=F((Me,ne)=>{"use strict";ne.exports={SMALLINT:{capacity:2},INTEGER:{capacity:4},BIGINT:{capacity:8},DECIMAL:{capacity:32},REAL:{capacity:4},"DOUBLE PRECISION":{capacity:8,mode:"floating"},BOOLEAN:{mode:"boolean"},VARCHAR:{mode:"varying"},CHAR:{size:1},DATE:{format:"YYYY-MM-DD"},TIMESTAMP:{format:"YYYY-MM-DD hh:mm:ss"},TIMESTAMPTZ:{format:"YYYY-MM-DD hh:mm:ssof"},GEOMETRY:{format:"spatial"},SUPER:{format:"semi-structured"},TIME:{format:"hh:mm:ss"},TIMETZ:{format:"hh:mm:ssof"},VARBYTE:{}}});var X=F((qe,ie)=>{"use strict";var Ne=require("lodash"),Re=o((l,p,y)=>Ne.has(p,"isActivated")&&!p.isActivated?y?"/* "+l+" */":l.includes(`
`)?`/*
`+l+` */
`:"// "+l:l,"commentIfDeactivated");ie.exports={commentIfDeactivated:Re}});var me=F((ve,ae)=>{"use strict";var oe=require("lodash"),Se=o((l,p,y)=>{let f=[];return l!==""&&f.push(l),p!==""&&f.push(p),y.statement&&f.push(y.statement),oe.isEmpty(f)?"":`
`+f.join(`
`)},"getTableAttributes"),Ce=o((l,p,y,f)=>{let a=[];return l&&a.push(l),p.statement&&p.isActivated&&a.push(p.statement),y.statement&&y.isActivated&&a.push(y.statement),f.forEach(C=>{a.push(C.statement)}),oe.isEmpty(a)?"":`,
	`+a.join(`,
	`)},"getTableConstraints"),Ke=o((l,p,y)=>{if(l==="")return"";let f=`${y?`,
	`:""}LIKE ${l}`;return p?f+" INCLUDING DEFAULTS":f},"getTableLikeConstraint");ae.exports={getTableAttributes:Se,getTableConstraints:Ce,getTableLikeConstraint:Ke}});var W=F((Fe,ce)=>{"use strict";var I=require("lodash"),{commentIfDeactivated:Z}=X();ce.exports=l=>{let{checkAllKeysActivated:p,clean:y,tab:f}=l.require("@hackolade/ddl-fe-utils").general,a=o(t=>String(t).replace(/'/g,"''").replace(/\\\\/g,"\\").replace(/\\/g,"\\\\"),"escape"),C=o(t=>I.isUndefined(t)?t:`'${a(t)}'`,"toString"),_=o(t=>I.toLower(t)==="none","isNone"),q=o(t=>I.toLower(t)==="auto","isAuto"),U=o(t=>_(t)?t:C(t),"toStringIfNotNone"),P=o(t=>q(t)?t:C(t),"toStringIfNotAuto"),Y=o(t=>isNaN(t)?"":Number(t),"toNumber"),v=o(t=>t===!0?"TRUE":"FALSE","toBoolean"),H=o(t=>Object.entries(t).filter(([e,r])=>!I.isEmpty(r)||r!==!1).map(([e,r])=>(Array.isArray(r)&&(r="("+r.filter(n=>!I.isEmpty(n)).join(", ")+")"),`${e}=${r}`)).join(`
`),"toOptions"),R=o((t,e,r)=>{if(e.GUID===t)return[{...e,name:r}];if(I.isPlainObject(e.properties)){let n=Object.keys(e.properties).reduce((s,d)=>{if(s.length)return s;let A=R(t,e.properties[d],d);return A?s.concat(A):s},[]);if(n.length)return[{...e,name:r}].concat(n)}else if(I.isArray(e.items)){let n=e.items.reduce((s,d)=>{if(s.length)return s;let A=R(t,d,"");return A?s.concat(A):s},[]);if(n.length)return[{...e,name:r}].concat(n)}else if(e.items){let n=R(t,e.items,"");if(n)return[{...e,name:r}].concat(n)}},"findJsonSchemaChain"),L=o(t=>{if(Array.isArray(t)){let e=", ",r=[],n=t.reduce((s,d)=>{let A=I.isString(d.name)?d.name.trim():d.trim();return I.get(d,"isActivated",!0)?[...s,A]:(r.push(A),s)},[]).filter(Boolean);return n.length===0?Z(r.join(e),{isActivated:!1},!0):r.length===0?n.join(e):n.join(e)+Z(e+r.join(e),{isActivated:!1},!0)}return t},"foreignKeysToString"),V=o(t=>t.map(e=>e.name.trim()).join(", "),"foreignActiveKeysToString"),i=o(t=>p(t.foreignKey)&&p(t.primaryKey)&&t.primaryTableActivated&&t.foreignTableActivated,"checkIfForeignKeyActivated"),c=o((t,e)=>{if(!e)return t.map(s=>s.name).join(`,
	`);let r=t.filter(s=>s.isActivated).map(s=>s.name),n=t.filter(s=>!s.isActivated).map(s=>s.name);return r.length===0?Z(n.join(`,
	`),{isActivated:!1},!0):n.length===0?r.join(`,
	`):r.join(`,
	`)+`
	`+Z(n.join(`,
	`),{isActivated:!1},!0)},"viewColumnsToString"),$=o(t=>e=>y({name:e.name?x(e.name,t):void 0,orReplace:e.orReplace,arguments:e.functionArguments||e.storedProcArgument||void 0,returnDataType:e.functionReturnType||e.storedProcDataType||void 0,volatility:e.functionVolatility||e.storedProcVolatility?(e.functionVolatility||e.storedProcVolatility).toUpperCase():void 0,statement:e.functionBody||e.storedProcFunction?f(I.trim(e.functionBody||e.storedProcFunction),"  "):void 0,language:e.functionLanguage||e.storedProcLanguage}),"hydrateUdf"),h=o(t=>e=>y({name:e.name?x(e.name,t):void 0,orReplace:e.orReplace,arguments:e.inputArgs||void 0,statement:e.body?f(I.trim(e.body)):void 0,securityMode:e.securityMode?`
SECURITY ${e.securityMode}`:void 0,configurationParameter:e.configurationParameter?`
SET configuration_parameter TO ${e.configurationParameter}`:void 0}),"hydrateProcedure"),B=o(t=>t.name&&t.arguments&&t.language&&t.returnDataType&&t.statement,"filterUdf"),G=o(t=>t.name&&t.arguments&&t.statement,"filterProcedure"),Q=o(t=>({...t,orReplace:t.orReplace?" OR REPLACE ":" "}),"setOrReplace"),x=o((t,e)=>{if(t&&e)return`"${e}"."${t}"`;if(!e)return`"${t}"`},"getCompositeName");return{toString:C,toNumber:Y,toBoolean:v,toOptions:H,toStringIfNotNone:U,toStringIfNotAuto:P,foreignKeysToString:L,checkIfForeignKeyActivated:i,foreignActiveKeysToString:V,viewColumnsToString:c,hydrateUdf:$,hydrateProcedure:h,filterUdf:B,filterProcedure:G,setOrReplace:Q,getCompositeName:x}}});var de=F((xe,le)=>{"use strict";var b=require("lodash"),{commentIfDeactivated:ue}=X();le.exports=l=>{let p=D(),y=l.require("@hackolade/ddl-fe-utils").assignTemplates,{toString:f}=W()(l),a=o((i,c)=>{i=b.toUpper(i);let $=i;return _(i)&&c.timePrecision&&!b.isNaN(c.timePrecision)&&($=`${i}(${c.timePrecision})`),["VARCHAR","CHAR","CHARACTER","VARBYTE"].includes(i)&&c.length&&!b.isNaN(c.length)&&($=`${i}(${c.length})`),["NUMBER","DECIMAL","NUMERIC"].includes(i)&&!b.isNaN(c.scale)&&!b.isNaN(c.precision)&&($=`${i}(${Number(c.precision)},${Number(c.scale)})`),$},"decorateType"),C=o(i=>["VARCHAR","NVARCHAR","TEXT","CHAR","CHARACTER VARYING","BPCHAR","CHARACTER","NCHAR"].includes(b.toUpper(i)),"isString"),_=o(i=>["TIME","TIMESTAMP","TIMESTAMPTZ","TIMETZ"].includes(b.toUpper(i)),"isTimestamp"),q=o(i=>i.replace(/^'([\S\s]+)'$/,"$1").replace(/'/g,"''"),"escapeString"),U=o((i,c)=>{let $=["current_timestamp","current_user","null"];return C(i)&&!$.includes(b.toLower(c))?`'${q(String(c))}'`:b.toUpper(i)==="BOOLEAN"?b.toUpper(c):c},"getDefault"),P=o((i,c)=>c?" QUOTA UNLIMITED":i?` QUOTA ${i} MB`:"","getQuota"),Y=o((i,c,$)=>{let h=["Redshift","Postgres"],B=i||c;return B&&h.includes($)?` SCHEMA "${B}"`:""},"getSourceSchemaNameForExternalSchema"),v=o((i,c)=>i&&["MYSQL","Postgres"].includes(c)?` SECRET_ARN ${i}`:"","getARN"),H=o((i,c,$)=>["Hive metastore","Postgres","MYSQL"].includes($)?i&&c?` URI ${i} PORT ${c}`:i?` URI ${i}`:"":"","getUri"),R=o((i,c)=>b.chain(c).filter("comment").map($=>{let h=y(p.comment,{object:"COLUMN",objectName:`${i}."${$.name}"`,comment:f($.comment)});return ue(h,$)}).join("").value(),"getColumnComments"),L=o(i=>i.map(c=>c.statement).join(`,
	`),"createColumnsStatements");return{getQuota:P,getSourceSchemaNameForExternalSchema:Y,getUri:H,getARN:v,decorateType:a,getDefault:U,getColumnComments:R,getColumnsDefinitions:o((i,c)=>{let[$,h]=b.partition(i,t=>!c||(t==null?void 0:t.isActivated)),B=L($),G=L(h),x=G.length?`
	`+ue(G,{isActivated:!1},!0):"";return`${B}${x}`},"getColumnsDefinitions")}}});var Ae=F((Ve,pe)=>{"use strict";pe.exports=l=>{let{foreignKeysToString:p,foreignActiveKeysToString:y}=W()(l),f=l.require("@hackolade/ddl-fe-utils").assignTemplates;return{generateConstraint:o((C,_,q,U={})=>{let P=C.map(R=>({...R,name:`"${R.name}"`})),Y=P.some(R=>R.isActivated),v=y(P);return Y&&q&&(v=p(P)),{statement:f(_,{...U,keys:v}),isActivated:Y}},"generateConstraint")}}});var u=require("lodash"),be=te(),m=D(),ye=se(),{commentIfDeactivated:Le}=X(),{getTableAttributes:j,getTableConstraints:Ie,getTableLikeConstraint:he}=me();module.exports=(l,p,y)=>{let{hasType:f}=y.require("@hackolade/ddl-fe-utils").general,a=y.require("@hackolade/ddl-fe-utils").assignTemplates,{foreignKeysToString:C,checkIfForeignKeyActivated:_,foreignActiveKeysToString:q,viewColumnsToString:U,hydrateUdf:P,hydrateProcedure:Y,filterUdf:v,filterProcedure:H,setOrReplace:R,getCompositeName:L,toString:V}=W()(y),{decorateType:i,getDefault:c,getQuota:$,getUri:h,getARN:B,getSourceSchemaNameForExternalSchema:G,getColumnComments:Q,getColumnsDefinitions:x}=de()(y),{generateConstraint:t}=Ae()(y);return{createDatabase({name:e,authorization:r,quota:n,sourceDBName:s,ifNotExist:d,sourceSchemaName:A,source:g,external:E,iamRole:T,secretARN:N,catalogRole:K,uri:S,region:O,createExternalDatabase:M,functions:z,procedures:Ee,comment:k}){let w,Te=a(m.comment,{object:"SCHEMA",objectName:L(e),comment:V(k)});E?w=a(m.createExternalSchema,{name:e,ifNotExist:d,source:g,sourceDBName:s,sourceSchemaName:A,region:O,uri:S,iamRole:T,secretARN:N,catalogRole:K,createExternalDatabase:M}):w=a(m.createSchema,{name:e,ifNotExist:d,authorization:r,quota:n});let $e=z.map(J=>a(m.createFunction,R(J))),ge=Ee.map(J=>a(m.createProcedure,R(J)));return[w,k?u.trimStart(Te):"",...$e,...ge].filter(Boolean).join(`
`)},createTable(e,r){let n=e.temporary?"TEMPORARY ":"",s=e.selectStatement,d=e.schemaName===""?"public":e.schemaName,A=a(m.comment,{object:"TABLE",objectName:L(e.name,d),comment:V(e.comment)}),g=Q(L(e.name,d),e.columnDefinitions);if(s)return a(m.createTableAs,{name:e.name,temporary:n,schemaName:d,backup:e.backup,tableAttributes:j(e.distStyle,e.distKey,e.compoundSortKey),query:s,comment:e.comment?A:"",columnDescriptions:g});let E=x(e.columns,r);return a(m.createTable,{name:e.name,schemaName:d,temporary:n,likeStatement:he(e.likeTableName,e.includeDefaults,!u.isEmpty(E)),ifNotExist:e.ifNotExist,columnDefinitions:E!==""?`
	`+E:"",tableConstraints:Ie(e.backup,e.compoundUniqueKey,e.compoundPrimaryKey,e.foreignKeyConstraints),tableAttributes:j(e.distStyle,e.distKey,e.compoundSortKey),comment:e.comment?A:"",columnDescriptions:g})},createView(e,r,n){if(u.isEmpty(e.keys))return"";let s=e.schemaName===""?"public":e.schemaName,{columnList:d,tableColumns:A,tables:g}=e.keys.reduce((T,N)=>{T.columnList.push({name:`"${N.alias||N.name}"`,isActivated:N.isActivated}),T.tableColumns.push({name:`"${N.entityName}"."${N.name}"`,isActivated:N.isActivated});let K=L(N.entityName,N.dbName);return N.entityName&&!T.tables.includes(K)&&T.tables.push(K),T},{columnList:[],tableColumns:[],tables:[]});if(u.isEmpty(g))return"";let E=a(m.comment,{object:"VIEW",objectName:L(e.name,s),comment:V(e.comment)});return e.materialized?a(m.createMaterializedView,{backup:e.backup?`
BACKUP YES`:"",name:e.name,schemaName:s,autoRefresh:e.autoRefresh?`
AUTO REFRESH YES`:"",tableAttributes:j(e.distStyle,e.distKey,{}),table_columns:u.isEmpty(A)?"":`
	`+U(A,n),table_name:g.join(", "),comment:e.comment?E:""}):a(m.createView,{orReplace:e.orReplace?" OR REPLACE":"",name:e.name,schemaName:s,column_list:U(d,n),withNoSchema:e.withNoSchema?" WITH NO SCHEMA BINDING":"",table_columns:u.isEmpty(A)?"":`
	`+U(A,n),table_name:g.join(", "),comment:e.comment?E:""})},createForeignKeyConstraint(e,r){let n=r.name?r.name:"public",s=_(e),d=s?C(e.foreignKey):q(e.foreignKey),A=s?C(e.primaryKey):q(e.primaryKey);return{statement:a(m.createTableForeignKey,{columns:'"'+d+'"',primary_table:`"${e.primarySchemaName||n}"."${e.primaryTable}"`,primary_columns:'"'+A+'"'}),isActivated:s}},convertColumnDefinition(e){return{statement:a(m.columnDefinition,{name:e.name,type:i(e.type,e),unique:e.unique?" UNIQUE":"",default:u.isUndefined(e.default)?"":" DEFAULT "+c(e.type,e.default),distKey:e.distKey?" DISTKEY":"",sortKey:e.sortKey?" SORTKEY":"",primaryKey:e.primaryKey?" PRIMARY KEY":"",notNull:e.nullable?"":" NOT NULL",encoding:e.encoding?` ENCODE ${e.encoding}`:"",references:""}),isActivated:e.isActivated}},hydrateDatabase(e,{udfs:r,procedures:n}={}){return{name:e.name,authorization:e.authorizationUsername?` AUTHORIZATION "${e.authorizationUsername}"`:"",quota:$(e.quota,e.unlimitedQuota),ifNotExist:e.ifNotExists?" IF NOT EXISTS":"",sourceDBName:e.federatedDatabaseName||e.dataCatalogDatabaseName||e.redshiftDatabaseName,sourceSchemaName:G(e.federatedSchemaName,e.redshiftSchemaName,e.fromSource),source:e.fromSource,external:e.external,iamRole:e.IAM_ROLE,secretARN:B(e.SECRET_ARN,e.fromSource),catalogRole:e.CATALOG_ROLE&&e.source==="Data catalog"?` CATALOG_ROLE ${e.CATALOG_ROLE}`:"",uri:h(e.URI,e.port,e.fromSource),region:e.source==="Data catalog"?e.region:"",createExternalDatabase:e.createExternalDatabaseIfNotExists?" CREATE EXTERNAL DATABASE IF NOT EXISTS":"",functions:Array.isArray(r)?r.map(P(e.name)).filter(v):[],procedures:Array.isArray(n)?n.map(Y(e.name)).filter(H):[],comment:e.description}},hydrateTable({tableData:e,entityData:r,jsonSchema:n}){let s=u.get(r,"[0]",{}),d=u.get(r,"[1]",{}),A=u.get(d,"uniqueKey[0].compositeUniqueKey",[]).map(S=>({name:S.name,isActivated:S.isActivated})),g=u.get(d,"primaryKey[0].compositePrimaryKey",[]).map(S=>({name:S.name,isActivated:S.isActivated})),E=s.autoSortKey??!0,T=u.toUpper(s.sortStyle||""),N=u.get(s,"sortKey[0].compositeSortKey",[]).map(S=>({name:S.name,isActivated:S.isActivated})),K=u.get(s,"distKey[0].compositeDistKey[0]",{});return{...e,comment:s.description,schemaName:e.dbData.name,selectStatement:s.selectStatement,includeDefaults:s.includeDefualts,likeTableName:u.get(e,`relatedSchemas[${s.like}].title`,""),temporary:n.temporary,ifNotExist:n.ifNotExists?" IF NOT EXISTS":"",backup:n.BACKUP?"BACKUP YES":"",distStyle:n.DISTSTYLE?`DISTSTYLE ${n.DISTSTYLE.toUpperCase()}`:"",distKey:!u.isEmpty(K)&&K.isActivated&&K.name?`DISTKEY ("${K.name}")`:"",compoundPrimaryKey:u.isEmpty(g)?"":t(g,m.compoundPrimaryKey,n.isActivated),compoundUniqueKey:u.isEmpty(A)?"":t(A,m.compoundUniqueKey,n.isActivated),compoundSortKey:u.isEmpty(N)||E?"":t(N,m.compoundSortKey,n.isActivated,{sortStyle:T}),query:""}},hydrateView({viewData:e,entityData:r}){let n=r[0],s=u.get(n,"distKey[0].compositeDistKey[0].name",""),{columnList:d,tableColumns:A,tables:g}=e.keys.reduce((E,T)=>(E.columnList.push({name:`"${T.alias||T.name}"`,isActivated:T.isActivated}),E.tableColumns.push({name:`"${T.entityName}"."${T.name}"`,isActivated:T.isActivated}),T.entityName&&!E.tables.includes(T.entityName)&&E.tables.push(T.entityName),E),{columnList:[],tableColumns:[],tables:[]});return u.isEmpty(g)?"":{...e,backup:n.BACKUP,schemaName:e.dbData.name,autoRefresh:n.autoRefresh,materialized:n.materialized,distStyle:n.DISTSTYLE?`DISTSTYLE ${n.DISTSTYLE.toUpperCase()}`:"",distKey:s!==""?`DISTKEY ("${s}")`:"",orReplace:n.orReplace,comment:n.description,withNoSchema:n.withNoSchemaBindings,table_name:g.join('" INNER JOIN "')}},getTypesDescriptors(){return ye},getDefaultType(e){return be[e]},hydrateViewColumn(e){return e},hasType(e){return f(ye,e)},hydrateColumn({columnDefinition:e,jsonSchema:r,dbData:n}){return{...e,comment:r.refDescription||r.description,unique:r.unique&&!r.compositeUniqueKey,distKey:r.distKey&&!r.compositeDistKey,sortKey:r.sortKey&&!r.compositeSortKey,primaryKey:e.primaryKey&&!r.compositePrimaryKey,encoding:r.encoding,references:""}},commentIfDeactivated(e,r,n){return Le(e,r,n)},dropSchema(e){return a(m.dropSchema,{name:e})},alterSchema({name:e,quota:r}){return a(m.alterSchema,{name:e,quota:r})},createUdf(e){return a(m.createFunction,R(e))},createProcedure(e){return a(m.createProcedure,R(e))},dropUdf(e){return a(m.dropFunction,e)},dropProcedure(e){return a(m.dropProcedure,e)},dropTable(e){return a(m.dropTable,{name:e})},alterTableOptions(e,r,{isPrimaryKeyModified:n,isUniqueKeyModified:s,isDistKeyModified:d,isSortKeyModified:A}){var T,N,K,S;let g=L(e.code||e.name,r.name),E=[];if(d){let O=e.DISTSTYLE?`DISTSTYLE ${e.DISTSTYLE.toUpperCase()}`:"",M=u.toUpper(e.DISTSTYLE)==="KEY"?`DISTKEY ${((S=(K=(N=(T=e.distKey)==null?void 0:T[0])==null?void 0:N.compositeDistKey)==null?void 0:K[0])==null?void 0:S.name)||""}`:"",z=`${O} ${M}`;E.push(a(m.alterDistKey,{name:g,distConstraint:z}))}if(A){let O=u.toUpper(e.sortStyle||""),M=u.get(e,"sortKey[0].compositeSortKey",[]),z=t(M,m.compoundSortKey,e.isActivated,{sortStyle:O}).statement;E.push(a(m.alterSortKey,{name:g,sortKeyConstraint:z}))}if(n&&!u.isEmpty(e.primaryKey)){let O=u.get(e,"primaryKey[0].compositePrimaryKey",[]),M=t(O,m.compoundPrimaryKey,e.isActivated).statement;E.push(a(m.alterPrimaryKey,{name:g,primaryKeyConstraint:M}))}if(s&&!u.isEmpty(e.uniqueKey)){let O=u.get(e,"uniqueKey[0].compositeUniqueKey",[]),M=t(O,m.compoundUniqueKey,e.isActivated).statement;E.push(a(m.alterUnique,{name:g,uniqueConstraint:M}))}return E.filter(Boolean).join(`

`)},renameColumn(e,r,n){return a(m.renameColumn,{tableName:e,oldColumnName:r,newColumnName:n})},alterColumnType(e,r){return a(m.alterColumnType,{tableName:e,columnName:r.name,type:i(r.type,r)})},addColumn(e,r){return a(m.addColumn,{tableName:e,columnStatement:r})},dropColumn(e,r){return a(m.dropColum,{tableName:e,columnName:r})},dropView(e){return a(m.dropView,{name:e})}}};
